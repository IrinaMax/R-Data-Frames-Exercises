# install.packages('tidyr')
> # install.packages('tidyr')
> # install.packages('tidyr')
> # install.packages('data.table')
> 
> library(tidyr)
> library(data.table)
> 
> # gather()  collaple multiple columns into key-pay values
> comp <- c(1,1,1,2,2,2,3,3,3)
> yr <- c(1998,1999,2000,1998,1999,2000,1998,1999,2000)
> q1 <- runif(9, min=0, max=100)
> q2 <- runif(9, min=0, max=100)
> q3 <- runif(9, min=0, max=100)
> q4 <- runif(9, min=0, max=100)
> 
> df <- data.frame(comp=comp,year=yr,Qtr1 = q1,Qtr2 = q2,Qtr3 = q3,Qtr4 = q4)
> df
  comp year      Qtr1      Qtr2     Qtr3      Qtr4
1    1 1998 19.860583 91.098349 33.79477 36.950702
2    1 1999 51.733551  3.324652 37.37142 21.925441
3    1 2000 57.703926 66.116310 96.30802 11.915279
4    2 1998 88.058762 28.827633 17.42776  3.102425
5    2 1999 39.809617 79.083791 64.13382 64.006702
6    2 2000 97.297314 28.127128 69.89763  7.462893
7    3 1998 36.027600 16.794035 63.23986 44.088919
8    3 1999  1.505022 42.635901 65.05079 32.918977
9    3 2000 42.196181 45.746504 53.23301 44.127645
> # Using Pipe Operator
> head(df %>% gather(Quarter,Revenue,Qtr1:Qtr4))
  comp year Quarter  Revenue
1    1 1998    Qtr1 19.86058
2    1 1999    Qtr1 51.73355
3    1 2000    Qtr1 57.70393
4    2 1998    Qtr1 88.05876
5    2 1999    Qtr1 39.80962
6    2 2000    Qtr1 97.29731
> # With just the function
> head(gather(df,Quarter,Revenue,Qtr1:Qtr4))
  comp year Quarter  Revenue
1    1 1998    Qtr1 19.86058
2    1 1999    Qtr1 51.73355
3    1 2000    Qtr1 57.70393
4    2 1998    Qtr1 88.05876
5    2 1999    Qtr1 39.80962
6    2 2000    Qtr1 97.29731
> # Spread() is a compliment of gather and
> stocks <- data.frame(
+   time = as.Date('2009-01-01') + 0:9,
+   X = rnorm(10, 0, 1),
+   Y = rnorm(10, 0, 2),
+   Z = rnorm(10, 0, 4)
+ )
> stocks
         time           X           Y          Z
1  2009-01-01 -1.62600045 -0.03834521  3.0114143
2  2009-01-02  0.16200371  2.00874276 -5.5749090
3  2009-01-03 -1.28157993  1.66395765 -0.5957669
4  2009-01-04 -0.14536120  3.43914907 -5.1773788
5  2009-01-05 -0.12881189  0.28107153 -0.3518457
6  2009-01-06 -1.09799057 -0.66320463 -6.1987670
7  2009-01-07  0.64237286 -2.17287669  1.2955681
8  2009-01-08  1.19470162 -1.03065206  1.5714716
9  2009-01-09  1.46516482 -1.68895448 -2.5516392
10 2009-01-10  0.05247386 -1.03978901 -5.3684982
> stocksm <- stocks %>% gather(stock, price, -time)
> # we can spred by different values also
>   stocksm %>% spread(stock, price)
         time           X           Y          Z
1  2009-01-01 -1.62600045 -0.03834521  3.0114143
2  2009-01-02  0.16200371  2.00874276 -5.5749090
3  2009-01-03 -1.28157993  1.66395765 -0.5957669
4  2009-01-04 -0.14536120  3.43914907 -5.1773788
5  2009-01-05 -0.12881189  0.28107153 -0.3518457
6  2009-01-06 -1.09799057 -0.66320463 -6.1987670
7  2009-01-07  0.64237286 -2.17287669  1.2955681
8  2009-01-08  1.19470162 -1.03065206  1.5714716
9  2009-01-09  1.46516482 -1.68895448 -2.5516392
10 2009-01-10  0.05247386 -1.03978901 -5.3684982
>   stocksm %>% spread(time, price)
  stock  2009-01-01 2009-01-02 2009-01-03 2009-01-04 2009-01-05 2009-01-06 2009-01-07
1     X -1.62600045  0.1620037 -1.2815799 -0.1453612 -0.1288119 -1.0979906  0.6423729
2     Y -0.03834521  2.0087428  1.6639577  3.4391491  0.2810715 -0.6632046 -2.1728767
3     Z  3.01141427 -5.5749090 -0.5957669 -5.1773788 -0.3518457 -6.1987670  1.2955681
  2009-01-08 2009-01-09  2009-01-10
1   1.194702   1.465165  0.05247386
2  -1.030652  -1.688954 -1.03978901
3   1.571472  -2.551639 -5.36849822
> # separate() and unit()   
>   df <- data.frame(x = c(NA, "a.x", "b.y", "c.z"))
>   df  
     x
1 <NA>
2  a.x
3  b.y
4  c.z
>   df %>% separate(x, c("ABC", "XYZ"))
   ABC  XYZ
1 <NA> <NA>
2    a    x
3    b    y
4    c    z
>   head(mtcars)
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
>   unite_(mtcars, "vs.am", c("vs","am"),sep = '.')
                     mpg cyl  disp  hp drat    wt  qsec vs.am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46   0.1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02   0.1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61   1.1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44   1.0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02   0.0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22   1.0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84   0.0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00   1.0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90   1.0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30   1.0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90   1.0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40   0.0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60   0.0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00   0.0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98   0.0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82   0.0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42   0.0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47   1.1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52   1.1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90   1.1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01   1.0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87   0.0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30   0.0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41   0.0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05   0.0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90   1.1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70   0.1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90   1.1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50   0.1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50   0.1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60   0.1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60   1.1    4    2
>   # Separate is the complement of unite
>   mtcars %>%
+     unite(vs_am, vs, am) %>%
+     separate(vs_am, c("vs", "am"))
                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
> 
